version: "3.7"
services:
  hubot:
    image: hubot
    build:
      context: .
      args:
        - HUBOT_ADAPTER=shell
        - HUBOT_DESCRIPTION=Delightfully aware robutt
        - HUBOT_NAME=Hubot
        - HUBOT_OWNER=Bot Wrangler <bw@example.com>
        - HUBOT_PACKAGES=proxy-agent
        - HUBOT_PORT=8080
        - http_proxy
        - https_proxy
        - no_proxy
    ports:
      - "8080:8080"
    environment:
      - http_proxy
      - https_proxy
      - no_proxy
    env_file:
      - hubot.env
    depends_on:
      - redis
    links:
      - redis
    volumes:
      - ./scripts:/hubot/scripts
      - ./external-scripts.json:/hubot/external-scripts.json
    tty: true
  redis:
    image: redis:buster
    command: redis-server --appendonly yes
    volumes:
      - hubot-brain:/data
volumes:
  hubot-brain:
